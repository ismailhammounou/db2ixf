Add more unit tests to improve coverage