Change parse to a generator to optimize the memory and let user more freedom